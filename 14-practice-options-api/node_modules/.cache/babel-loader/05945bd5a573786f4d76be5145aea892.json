{"remainingRequest":"/Users/slag/Documents/GitHub/VMinin/14-practice-options-api/node_modules/babel-loader/lib/index.js!/Users/slag/Documents/GitHub/VMinin/14-practice-options-api/src/store/modules/auth.module.js","dependencies":[{"path":"/Users/slag/Documents/GitHub/VMinin/14-practice-options-api/src/store/modules/auth.module.js","mtime":1657442942244},{"path":"/Users/slag/Documents/GitHub/VMinin/14-practice-options-api/node_modules/cache-loader/dist/cjs.js","mtime":1657261957447},{"path":"/Users/slag/Documents/GitHub/VMinin/14-practice-options-api/node_modules/babel-loader/lib/index.js","mtime":1657261957881}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3NsYWcvRG9jdW1lbnRzL0dpdEh1Yi9WTWluaW4vMTQtcHJhY3RpY2Utb3B0aW9ucy1hcGkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvc2xhZy9Eb2N1bWVudHMvR2l0SHViL1ZNaW5pbi8xNC1wcmFjdGljZS1vcHRpb25zLWFwaS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCB7IGVycm9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3InOwp2YXIgVE9LRU5fS0VZID0gJ2p3dCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBmdW5jdGlvbiBzdGF0ZSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9LRVkpCiAgICB9OwogIH0sCiAgZ2V0dGVyczogewogICAgdG9rZW46IGZ1bmN0aW9uIHRva2VuKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS50b2tlbjsKICAgIH0sCiAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZChzdGF0ZSkgewogICAgICByZXR1cm4gISFzdGF0ZS50b2tlbjsKICAgIH0KICB9LAogIG11dGF0aW9uczogewogICAgc2V0VG9rZW46IGZ1bmN0aW9uIHNldFRva2VuKHN0YXRlLCB0b2tlbikgewogICAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShUT0tFTl9LRVksIHRva2VuKTsKICAgIH0sCiAgICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChzdGF0ZSkgewogICAgICBzdGF0ZS50b2tlbiA9IG51bGw7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX0tFWSk7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgcGF5bG9hZCkgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBjb21taXQsIGRpc3BhdGNoLCB1cmwsIF95aWVsZCRheGlvcyRwb3N0LCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb21taXQgPSBfcmVmLmNvbW1pdCwgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE7CiAgICAgICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vdjEvYWNjb3VudHM6c2lnbkluV2l0aFBhc3N3b3JkP2tleT0iLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX0ZCX0tFWSk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KHVybCwgX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBwYXlsb2FkKSwge30sIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX3lpZWxkJGF4aW9zJHBvc3QgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCRheGlvcyRwb3N0LmRhdGE7CiAgICAgICAgICAgICAgICBjb21taXQoJ3NldFRva2VuJywgZGF0YS5pZFRva2VuKTsKICAgICAgICAgICAgICAgIGNvbW1pdCgnY2xlYXJNZXNzYWdlJywgbnVsbCwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDExOwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICAgIGRpc3BhdGNoKCdzZXRNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICB2YWx1ZTogZXJyb3IoX2NvbnRleHQudDAucmVzcG9uc2UuZGF0YS5lcnJvci5tZXNzYWdlKSwKICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMSwgMTFdXSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/slag/Documents/GitHub/VMinin/14-practice-options-api/src/store/modules/auth.module.js"],"names":["axios","error","TOKEN_KEY","namespaced","state","token","localStorage","getItem","getters","isAuthenticated","mutations","setToken","setItem","logout","removeItem","actions","login","payload","commit","dispatch","url","process","env","VUE_APP_FB_KEY","post","returnSecureToken","data","idToken","root","value","response","message","type","Error"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,KAAR,QAAoB,mBAApB;AACA,IAAMC,SAAS,GAAG,KAAlB;AAEA,eAAe;AACdC,EAAAA,UAAU,EAAE,IADE;AAEdC,EAAAA,KAFc,mBAEN;AACP,WAAO;AACNC,MAAAA,KAAK,EAAEC,YAAY,CAACC,OAAb,CAAqBL,SAArB;AADD,KAAP;AAGA,GANa;AAOdM,EAAAA,OAAO,EAAE;AACRH,IAAAA,KADQ,iBACFD,KADE,EACK;AACZ,aAAOA,KAAK,CAACC,KAAb;AACA,KAHO;AAIRI,IAAAA,eAJQ,2BAIQL,KAJR,EAIe;AACtB,aAAO,CAAC,CAACA,KAAK,CAACC,KAAf;AACA;AANO,GAPK;AAedK,EAAAA,SAAS,EAAE;AACVC,IAAAA,QADU,oBACDP,KADC,EACMC,KADN,EACa;AACtBD,MAAAA,KAAK,CAACC,KAAN,GAAcA,KAAd;AACAC,MAAAA,YAAY,CAACM,OAAb,CAAqBV,SAArB,EAAgCG,KAAhC;AACA,KAJS;AAKVQ,IAAAA,MALU,kBAKHT,KALG,EAKI;AACbA,MAAAA,KAAK,CAACC,KAAN,GAAc,IAAd;AACAC,MAAAA,YAAY,CAACQ,UAAb,CAAwBZ,SAAxB;AACA;AARS,GAfG;AAyBda,EAAAA,OAAO,EAAE;AACFC,IAAAA,KADE,uBACwBC,OADxB,EACiC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAA5BC,gBAAAA,MAA4B,QAA5BA,MAA4B,EAApBC,QAAoB,QAApBA,QAAoB;AAAA;AAEjCC,gBAAAA,GAFiC,uFAEkDC,OAAO,CAACC,GAAR,CAAYC,cAF9D;AAAA;AAAA,uBAGlBvB,KAAK,CAACwB,IAAN,CAAWJ,GAAX,kCAAoBH,OAApB;AAA6BQ,kBAAAA,iBAAiB,EAAE;AAAhD,mBAHkB;;AAAA;AAAA;AAGhCC,gBAAAA,IAHgC,qBAGhCA,IAHgC;AAIvCR,gBAAAA,MAAM,CAAC,UAAD,EAAaQ,IAAI,CAACC,OAAlB,CAAN;AACAT,gBAAAA,MAAM,CAAC,cAAD,EAAiB,IAAjB,EAAuB;AAACU,kBAAAA,IAAI,EAAE;AAAP,iBAAvB,CAAN;AALuC;AAAA;;AAAA;AAAA;AAAA;AAOvCT,gBAAAA,QAAQ,CAAC,YAAD,EAAe;AACtBU,kBAAAA,KAAK,EAAE5B,KAAK,CAAC,YAAE6B,QAAF,CAAWJ,IAAX,CAAgBzB,KAAhB,CAAsB8B,OAAvB,CADU;AAEtBC,kBAAAA,IAAI,EAAE;AAFgB,iBAAf,EAGL;AAACJ,kBAAAA,IAAI,EAAE;AAAP,iBAHK,CAAR;AAPuC,sBAWjC,IAAIK,KAAJ,EAXiC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaxC;AAdO;AAzBK,CAAf","sourcesContent":["import axios from \"axios\";\nimport {error} from '../../utils/error'\nconst TOKEN_KEY = 'jwt'\n\nexport default {\n\tnamespaced: true,\n\tstate() {\n\t\treturn {\n\t\t\ttoken: localStorage.getItem(TOKEN_KEY)\n\t\t}\n\t},\n\tgetters: {\n\t\ttoken(state) {\n\t\t\treturn state.token\n\t\t},\n\t\tisAuthenticated(state) {\n\t\t\treturn !!state.token\n\t\t}\n\t},\n\tmutations: {\n\t\tsetToken(state, token) {\n\t\t\tstate.token = token\n\t\t\tlocalStorage.setItem(TOKEN_KEY, token)\n\t\t},\n\t\tlogout(state) {\n\t\t\tstate.token = null\n\t\t\tlocalStorage.removeItem(TOKEN_KEY)\n\t\t}\n\t},\n\tactions: {\n\t\tasync login({commit, dispatch}, payload) {\n\t\t\ttry {\n\t\t\t\tconst url = `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=${process.env.VUE_APP_FB_KEY}`\n\t\t\t\tconst {data} = await axios.post(url, {...payload, returnSecureToken: true})\n\t\t\t\tcommit('setToken', data.idToken)\n\t\t\t\tcommit('clearMessage', null, {root: true})\n\t\t\t} catch (e) {\n\t\t\t\tdispatch('setMessage', {\n\t\t\t\t\tvalue: error(e.response.data.error.message),\n\t\t\t\t\ttype: 'danger'\n\t\t\t\t}, {root: true})\n\t\t\t\tthrow new Error()\n\t\t\t}\n\t\t}\n\t}\n}\n"]}]}